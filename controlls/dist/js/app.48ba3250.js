(function(t){function e(e){for(var i,l,u=e[0],a=e[1],s=e[2],v=0,f=[];v<u.length;v++)l=u[v],r[l]&&f.push(r[l][0]),r[l]=0;for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i]);o&&o(e);while(f.length)f.shift()();return c.push.apply(c,s||[]),n()}function n(){for(var t,e=0;e<c.length;e++){for(var n=c[e],i=!0,u=1;u<n.length;u++){var a=n[u];0!==r[a]&&(i=!1)}i&&(c.splice(e--,1),t=l(l.s=n[0]))}return t}var i={},r={app:0},c=[];function l(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=t,l.c=i,l.d=function(t,e,n){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)l.d(n,i,function(e){return t[e]}.bind(null,i));return n},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],a=u.push.bind(u);u.push=e,u=u.slice();for(var s=0;s<u.length;s++)e(u[s]);var o=a;c.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"1dc3":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d");var i=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("CtrlWrap")],1)},c=[],l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ctrl__wrap"},t._l(t.list,function(t,e){return n("ctrl-input",{key:e,attrs:{item:t}})}),1)},u=[],a=n("2f62"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ctrl__row"},[n("div",{staticClass:"ctrl__item"},[n("div",{staticClass:"ctrl__title"},[t._v(t._s(t.item.title))]),n("div",{ref:"box",staticClass:"ctrl__input",class:{active:t.item.active},on:{blur:function(e){t.setActive(!1)}}},[n("div",{staticClass:"ctrl__input-front",on:{click:function(e){e.preventDefault(),t.setActive(!0)}}},[t._v(t._s(t.format(t.item.value)))]),n("div",{staticClass:"ctrl__input-box"},[t.setFocus?n("input",{ref:"input",staticClass:"ctrl__input-field",attrs:{type:"number",n:t.item.ctrl,min:"0",step:"1"},domProps:{value:t.item.value},on:{input:function(e){return"button"in e||!t._k(e.keyCode,"number",void 0,e.key,void 0)?t.setValue(e):null},keyup:[function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.setActive(!1)},function(e){if(!("button"in e)&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.resetValue()}],keydown:function(e){return"button"in e||!t._k(e.keyCode,"tab",9,e.key,"Tab")?(e.preventDefault(),t.nextInput(e)):null},keydup:function(e){return"button"in e||!t._k(e.keyCode,"tab",9,e.key,"Tab")?(e.stopPropagation(),e.preventDefault(),t.prevInput(e)):null}}}):t._e(),t.item.btn?n("div",{staticClass:"ctrl__input-btn",on:{click:t.callback}},[t._v(t._s(t.item.btn))]):t._e()])])])])},o=[],v=(n("a481"),n("f751"),{name:"ctrl-input",props:["item"],data:function(){return{value_prev:!1}},computed:{setFocus:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.item;return t.active?(!1===this.value_prev&&(this.value_prev=t.value),this.$store.commit("setValue",{ctrl:t.ctrl,value:0===t.value?"":t.value}),this.$nextTick(function(){this.$refs.input.focus()})):this.$nextTick(function(){this.value_prev=!1,this.$store.commit("setValue",{ctrl:t.ctrl,value:""===t.value?0:t.value}),this.$refs.input.blur()}),!0}},methods:{setActive:function(t){var e=this;new Promise(function(n){n(e.$store.dispatch("setActive",{ctrl:e.item.ctrl,active:t}))})},setValue:function(t){this.$store.dispatch("setValue",{item:Object.assign({},this.item),value:t.target.value})},resetValue:function(){var t=this;new Promise(function(e){e(t.$store.dispatch("setValue",{item:Object.assign({},t.item),value:t.value_prev}))}).then(function(){t.setActive(!1)})},format:function(t){return String(t).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")},prevInput:function(t){},nextInput:function(t){var e=this;new Promise(function(t){t(e.setActive(!1))}).then(function(){return e.$store.dispatch("tabActive",{item:e.item,dir:!t.shiftKey})}).then(function(t){new Promise(function(n){n(e.$store.dispatch("setActive",{ctrl:t.ctrl,active:!0}))})})},callback:function(){this.$store.dispatch(this.item.callback)},showField:function(){this.item.active&&event.target!=this.$refs.box&&!this.$refs.box.contains(event.target)&&this.setActive(!1)}},mounted:function(){document.addEventListener("click",this.showField,!1)},beforeDestroy:function(){document.removeEventListener("click",this.showField)}}),f=v,p=n("2877"),m=Object(p["a"])(f,s,o,!1,null,null,null);m.options.__file="CtrlInput.vue";var d=m.exports,b={name:"CtrlWrap",components:{CtrlInput:d},computed:Object(a["b"])({list:function(t){return t.list}})},h=b,_=Object(p["a"])(h,l,u,!1,null,null,null);_.options.__file="CtrlWrap.vue";var k=_.exports,y={name:"app",components:{CtrlWrap:k}},g=y,w=Object(p["a"])(g,r,c,!1,null,null,null);w.options.__file="App.vue";var C=w.exports;i["a"].use(a["a"]);var O=new a["a"].Store({state:{constanta:1e3,list:[{value:0,title:"Контрол 1",ctrl:"ctrl1",callback:"sum",btn:"Сумма",active:!1},{value:0,title:"Контрол 2",ctrl:"ctrl2",callback:"constanta",btn:"Константа",active:!1},{value:0,title:"Контрол 3",ctrl:"ctrl3",btn:!1,active:!1}]},mutations:{setValue:function(t,e){t.list=t.list.map(function(t){return t.ctrl==e.ctrl?Object.assign(t,{value:e.value}):t})},setActive:function(t,e){t.list=t.list.map(function(t){return t.ctrl==e.ctrl?Object.assign(t,{active:e.active}):t})},setSum:function(t,e){t.list=t.list.map(function(t){return"ctrl1"==t.ctrl?Object.assign(t,{value:e.value}):t})},constanta:function(t,e){t.list=t.list.map(function(e){return"ctrl1"!=e.ctrl?Object.assign(e,{value:t.constanta}):e})}},actions:{setActive:function(t,e){var n=t.commit;n("setActive",e)},setValue:function(t,e){var n=t.commit;parseInt(e.item.value)<0?n("setValue",{ctrl:e.item.ctrl,value:0}):"ctrl1"!=e.item.ctrl?(""===e.value&&"ctrl3"==e.item.ctrl||n("setValue",{ctrl:"ctrl2",value:e.value}),""===e.value&&"ctrl2"==e.item.ctrl||n("setValue",{ctrl:"ctrl3",value:e.value})):n("setValue",{ctrl:e.item.ctrl,value:e.value})},sum:function(t){var e=t.commit,n=t.state,i=0;n.list.map(function(t){"ctrl1"!=t.ctrl&&(i+=parseInt(t.value))}),e("setSum",{value:i})},constanta:function(t){var e=t.commit;e("constanta")},tabActive:function(t,e){var n=t.state;return new Promise(function(t){var i=0;n.list.map(function(t,n){e.item.ctrl==t.ctrl&&(i=n)}),e.dir?i==n.list.length-1?i=0:i++:i?i--:i=n.list.length-1,t(Object.assign({},n.list.filter(function(t,e){return e==i})[0]))})}}});n("1dc3");i["a"].config.productionTip=!1,new i["a"]({store:O,render:function(t){return t(C)}}).$mount("#app")}});
//# sourceMappingURL=app.48ba3250.js.map